/*	This work is licensed under Creative Commons GNU LGPL License.

	License: http://creativecommons.org/licenses/LGPL/2.1/
   Version: 0.9
	Author:  Stefan Goessner/2006
	Web:     http://goessner.net/ 
*/
function xml2json(e,t){var n={toObj:function(e){var t={};if(e.nodeType==1){if(e.attributes.length)for(var r=0;r<e.attributes.length;r++)t[e.attributes[r].nodeName]=(e.attributes[r].value||"").toString();if(e.firstChild){var i=0,s=0,o=false;for(var u=e.firstChild;u;u=u.nextSibling){if(u.nodeType==1)o=true;else if(u.nodeType==3&&u.nodeValue.match(/[^ \f\n\r\t\v]/))i++;else if(u.nodeType==4)s++}if(o){if(i<2&&s<2){n.removeWhite(e);for(var u=e.firstChild;u;u=u.nextSibling){if(u.nodeType==3)t["#text"]=n.escape(u.nodeValue);else if(u.nodeType==4)t["#cdata"]=n.escape(u.nodeValue);else if(t[u.nodeName]){if(t[u.nodeName]instanceof Array)t[u.nodeName][t[u.nodeName].length]=n.toObj(u);else t[u.nodeName]=[t[u.nodeName],n.toObj(u)]}else t[u.nodeName]=n.toObj(u)}}else{if(!e.attributes.length)t=n.escape(n.innerXml(e));else t["#text"]=n.escape(n.innerXml(e))}}else if(i){if(!e.attributes.length)t=n.escape(n.innerXml(e));else t["#text"]=n.escape(n.innerXml(e))}else if(s){if(s>1)t=n.escape(n.innerXml(e));else for(var u=e.firstChild;u;u=u.nextSibling)t["#cdata"]=n.escape(u.nodeValue)}}if(!e.attributes.length&&!e.firstChild)t=null}else if(e.nodeType==9){t=n.toObj(e.documentElement)}else alert("unhandled node type: "+e.nodeType);return t},toJson:function(e,t,r){var i=t?'"'+t+'"':"";if(e instanceof Array){for(var s=0,o=e.length;s<o;s++)e[s]=n.toJson(e[s],"",r+"	");i+=(t?":[":"[")+(e.length>1?"\n"+r+"	"+e.join(",\n"+r+"	")+"\n"+r:e.join(""))+"]"}else if(e==null)i+=(t&&":")+"null";else if(typeof e=="object"){var u=[];for(var a in e)u[u.length]=n.toJson(e[a],a,r+"	");i+=(t?":{":"{")+(u.length>1?"\n"+r+"	"+u.join(",\n"+r+"	")+"\n"+r:u.join(""))+"}"}else if(typeof e=="string")i+=(t&&":")+'"'+e.toString()+'"';else i+=(t&&":")+e.toString();return i},innerXml:function(e){var t="";if("innerHTML"in e)t=e.innerHTML;else{var n=function(e){var t="";if(e.nodeType==1){t+="<"+e.nodeName;for(var r=0;r<e.attributes.length;r++)t+=" "+e.attributes[r].nodeName+'="'+(e.attributes[r].nodeValue||"").toString()+'"';if(e.firstChild){t+=">";for(var i=e.firstChild;i;i=i.nextSibling)t+=n(i);t+="</"+e.nodeName+">"}else t+="/>"}else if(e.nodeType==3)t+=e.nodeValue;else if(e.nodeType==4)t+="<![CDATA["+e.nodeValue+"]]>";return t};for(var r=e.firstChild;r;r=r.nextSibling)t+=n(r)}return t},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var t=e.firstChild;t;){if(t.nodeType==3){if(!t.nodeValue.match(/[^ \f\n\r\t\v]/)){var r=t.nextSibling;e.removeChild(t);t=r}else t=t.nextSibling}else if(t.nodeType==1){n.removeWhite(t);t=t.nextSibling}else t=t.nextSibling}return e}};if(e.nodeType==9)e=e.documentElement;var r=n.toJson(n.toObj(n.removeWhite(e)),e.nodeName,"	");return"{\n"+t+(t?r.replace(/\t/g,t):r.replace(/\t|\n/g,""))+"\n}"}