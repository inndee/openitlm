var ServerUrl="http://devcola.com/public_data/loadxml.php";var LicenseStatus=[];function getArraySubObjects(a){if(a.constructor!=Array){var b=[];b.push(a);return b}else{return a}}function removeDuplicatesInArray(a){var b=a.filter(function(c,d){return a.indexOf(c)==d});return b}function getServerUrl(){var a=Math.round(Math.random()*10000);return ServerUrl+"?rand="+a}function epochToDate(c){c=parseFloat(c)*1000;var b="/Date("+c+")/";var a=new Date(parseFloat(b.substr(6)));return a.toLocaleString()}function capitaliseFirstLetter(a){return a.charAt(0).toUpperCase()+a.slice(1)}function parseXML(a){var b;if(window.DOMParser){parser=new DOMParser();b=parser.parseFromString(a,"text/xml");console.log("Verbose: parsing xml data.")}else{b=new ActiveXObject("Microsoft.XMLDOM");b.async=false;b.loadXML(a)}return b}function convertToJson(b){var a=parseXML(b);return JSON.parse(xml2json(a,""))}function prepareDataListing(){if(LicenseStatus.length==0||LicenseStatus.realtime==null){ERROR("prepareDataForListing:Failed to prepare data LicenseStatus is empty");return false}var b=[];var d=0;getArraySubObjects(LicenseStatus.realtime.vendorlicenses.vendorlicense).forEach(function(i){var g=0;var h=0;getArraySubObjects(i.daemons.daemon.features.feature).forEach(function(j){g+=parseInt(j.licenses);h+=parseInt(j.used)});i.totallicenses=g;i.inuse=h;i.html=formatHTMLProductItem(i);i.id=d++;b.push(i)});LicenseStatus.realtime.productlist=b;d=0;var a=[];getArraySubObjects(LicenseStatus.realtime.vendorlicenses.vendorlicense).forEach(function(g){getArraySubObjects(g.daemons.daemon.features.feature).forEach(function(h){h.productname=g.name;h.daemon_name=g.daemons.daemon.name;h.daemon_status=g.daemons.daemon.status;h.daemon_version=g.daemons.daemon.version;h.html=formatHTMLFeatureItem(h);h.id=d++;a.push(h)})});LicenseStatus.realtime.featureslist=a;var c=[];getArraySubObjects(a).forEach(function(g){if(g.online==null){return}getArraySubObjects(g.online.entry).forEach(function(h){h.productname=g.productname;h.featurename=g.name;c.push(h)})});var e=[];getArraySubObjects(c).forEach(function(g){e.push(g.user)});e=removeDuplicatesInArray(e);var f=[];getArraySubObjects(e).forEach(function(i){var h=[];getArraySubObjects(c).forEach(function(j){if(i==j.user){h.push(j)}});var g=formatHTMLUserItem(i,h);f.push({name:i,use:h,html:g})});LicenseStatus.realtime.userslist=f}function formatHTMLProductItem(a){var d="<img src='graphics/product-icon-sm.png' width='20px'>";var c="<h3>"+d+a.name+"</h3>";var h="";var g=parseInt((a.inuse/a.totallicenses)*100);if(g!=0){h="<hr align='left' width='"+g+"%' />"}var b="";b+="<p class='inline'>Type: "+a.type+"</p>";b+="<p class='inline'>polltime: "+epochToDate(a.polltime)+"</p><br/>";if(a.servers!=undefined){b+="<p class='inline'>Server: "+a.servers.server.name+":"+a.servers.server.port+"</p><br/>"}b+="<br/><h6 class='inline' >Total Licenses: "+a.totallicenses+"</h6>   <h6 class='inline'>In Use Licenses: "+a.inuse+"</h6>";var f="<br/><br/><div class='meterbar'>"+h+"</div>";var e=c+b+f;return e}function formatHTMLFeatureItem(a){var d="<img src='graphics/feature-icon-sm.png' width='20px'>";var c="<h3>"+d+a.name+" </h3>";var h="";var g=parseInt((a.used/a.licenses)*100);if(g!=0){h="<hr align='left' width='"+g+"%' />"}var b="";b+="<p>Version: "+a.version+"</p></br/><br/>";b+="<p>Product name: "+a.productname+"</p>";b+="<p>Expires: "+epochToDate(a.expires)+"</p>";b+="<h4 class='inline'>Total Licenses: "+a.licenses+"</h4>   <h4 class = 'inline'>In Use Licenses: "+a.used+"</h4>";var f="<br/><br/><div class='meterbar'>"+h+"</div>";var e=c+b+f;return e}function formatHTMLUserItem(f,e){var c="<img src='graphics/user-icon-sm.png' width='20px'>";var b="<h3>"+c+f+" </h3>";var a="<h4>Use licenses: "+e.length+"</h4>";var d=b+a;return d}function removeDuplicatesInArray(a){var b=a.filter(function(c,d){return a.indexOf(c)==d});return b};